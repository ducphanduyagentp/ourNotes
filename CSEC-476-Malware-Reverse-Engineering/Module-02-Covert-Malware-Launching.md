# Covert Malware Launching

## Launchers

- .rsrc section, download from URL
- Common function calls to load resources
    - FindResource
    - LoadResource
    - SizeofResource

## Process Injection

- API calls
    - VirtualAllocEx
    - WriteProcessMemory

### DLL Injection

- API calls
    - Obtain handler to victim process: CreateToolhelp32Snapshot, Process32First, Process32Next
    - Create and execute a new thread in the remote process: CreateRemoteThread
- The victim process needs to call LoadLibrary and has the name of the DLL in the same space (using VirtualAllocEx above)
- Only injecting the name so LoadLibrary can call it. (Different from hooking in Ch.11)

### Direct Injection

- Code of the DLL instead of the name is injected.

## Process Replacment

- Replace the whole running process with a malicious process
- Create suspended so it won't run without privileges
- SetThreadContext so it uses privileges

## Hook Injection